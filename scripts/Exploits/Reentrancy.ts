import {ethers, network} from "hardhat"

async function main() {
    const vuln = await ethers.getContractFactory("Vulnerable")
    const Vuln = await vuln.deploy()

    const expl = await ethers.getContractFactory("Exploit")
    const Expl = await expl.deploy(Vuln.target)

    const [, acc2 ] = await ethers.getSigners()

    const targetAddress = Vuln.target

    await acc2.sendTransaction({ to: targetAddress, value: ethers.parseEther("1")})

    //Now the exploit

    await Expl.exploit()

    console.log(await ethers.provider.getBalance(Expl.target))
}
main().catch((error) => {
    console.error(error)
    process.exitCode=1
})